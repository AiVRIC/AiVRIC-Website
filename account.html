<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<parameter name="http-equiv" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

<title>Account - AIVric</title>

<!-- Fav Icon -->
<link rel="icon" href="assets/images/favicon.ico" type="image/x-icon">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

<!-- Stylesheets -->
<link href="assets/css/font-awesome-all.css" rel="stylesheet">
<link href="assets/css/flaticon.css" rel="stylesheet">
<link href="assets/css/owl.css" rel="stylesheet">
<link href="assets/css/bootstrap.css" rel="stylesheet">
<link href="assets/css/jquery.fancybox.min.css" rel="stylesheet">
<link href="assets/css/animate.css" rel="stylesheet">
<link href="assets/css/nice-select.css" rel="stylesheet">
<link href="assets/css/color.css" rel="stylesheet">
<link href="assets/css/elpath.css" rel="stylesheet">
<link href="assets/css/style.css" rel="stylesheet">
<link href="assets/css/elements-css/page-title.css" rel="stylesheet">
<link href="assets/css/responsive.css" rel="stylesheet">

<!-- Stripe.js -->
<script src="https://js.stripe.com/v3/"></script>

<style>
    .subscription-card {
        background: #fff;
        border-radius: 10px;
        padding: 30px;
        box-shadow: 0 0 20px rgba(0,0,0,0.1);
        margin-bottom: 30px;
    }
    .subscription-status {
        display: inline-block;
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: 600;
    }
    .status-active {
        background: #28a745;
        color: white;
    }
    .status-inactive {
        background: #dc3545;
        color: white;
    }
    .status-trial {
        background: #17a2b8;
        color: white;
    }
    .subscription-detail {
        margin: 15px 0;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 5px;
    }
    .loading-spinner {
        text-align: center;
        padding: 50px;
    }
    .spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #3498db;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 0 auto;
    }
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    .product-badge {
        display: inline-block;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 8px 16px;
        border-radius: 5px;
        margin: 5px 5px 5px 0;
        font-size: 14px;
    }
</style>

</head>

<!-- page wrapper -->
<body>

    <div class="boxed_wrapper">

        <!-- preloader -->
        <div class="loader-wrap">
            <div class="preloader">
                <div class="preloader-close">x</div>
                <div id="handle-preloader" class="handle-preloader">
                    <div class="animation-preloader">
                        <div class="spinner"></div>
                        <div class="txt-loading">
                            <span data-text-preloader="A" class="letters-loading">A</span>
                            <span data-text-preloader="I" class="letters-loading">I</span>
                            <span data-text-preloader="V" class="letters-loading">V</span>
                            <span data-text-preloader="r" class="letters-loading">r</span>
                            <span data-text-preloader="i" class="letters-loading">i</span>
                            <span data-text-preloader="c" class="letters-loading">c</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- preloader end -->

        <!-- main header -->
        <header class="main-header header-style-two">
            <!-- header-top -->
            <div class="header-top">
                <div class="auto-container">
                    <div class="top-inner">
                        <div class="top-left">
                            <ul class="info clearfix">
                                <li><i class="icon-1"></i>Mon-Fri 8:00 am-6:00 pm</li>
                                <li><i class="icon-2"></i><a href="tel:912136660027">+91-213-666-0027</a></li>
                                <li><i class="icon-3"></i><a href="mailto:info@example.com">info@example.com</a></li>
                            </ul>
                        </div>
                        <div class="top-right">
                            <div class="login"><a href="index.html">Logout</a></div>
                            <ul class="social-links clearfix">
                                <li><a href="index.html"><i class="fab fa-facebook-f"></i></a></li>
                                <li><a href="index.html"><i class="fab fa-twitter"></i></a></li>
                                <li><a href="index.html"><i class="fab fa-linkedin-in"></i></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- header-lower -->
            <div class="header-lower">
                <div class="auto-container">
                    <div class="outer-box">
                        <div class="logo-box">
                            <figure class="logo"><a href="index.html"><img src="assets/images/logo/aivric.svg" alt=""></a></figure>
                        </div>
                        <div class="menu-area clearfix">
                            <!--Mobile Navigation Toggler-->
                            <div class="mobile-nav-toggler">
                                <i class="icon-bar"></i>
                                <i class="icon-bar"></i>
                                <i class="icon-bar"></i>
                            </div>
                            <nav class="main-menu navbar-expand-md navbar-light">
                                <div class="collapse navbar-collapse show clearfix" id="navbarSupportedContent">
                                    <ul class="navigation clearfix">
                                        <li class="dropdown"><a href="services.html">Platform</a>
                                            <ul>
                                                <li><a href="services.html#scanning">Security & Risk Assessment</a></li>
                                                <li><a href="services.html#compliance">Compliance Management</a></li>
                                                <li><a href="services.html#remediation">AI-Powered Remediation</a></li>
                                             </ul>
                                        </li>
                                        <li><a href="pricing.html">Pricing</a></li>
                                        <li class="current"><a href="account.html">Account</a></li>
                                    </ul>
                                </div>
                            </nav>
                        </div>
                        <ul class="menu-right-content">
                            <li class="search-box-outer search-toggler">
                                <i class="icon-4"></i>
                            </li>
                            <li class="btn-box">
                                <a href="contact.html" class="theme-btn-one">Request a Demo</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!--sticky Header-->
            <div class="sticky-header">
                <div class="auto-container">
                    <div class="outer-box">
                        <div class="logo-box">
                            <figure class="logo"><a href="index.html"><img src="assets/images/logo/aivric.svg" alt=""></a></figure>
                        </div>
                        <div class="menu-area clearfix">
                            <nav class="main-menu clearfix">
                                <!--Keep This Empty / Menu will come through Javascript-->
                            </nav>
                        </div>
                        <ul class="menu-right-content">
                            <li class="search-box-outer search-toggler">
                                <i class="icon-4"></i>
                            </li>
                            <li class="btn-box">
                                <a href="contact.html" class="theme-btn-one">Request a Demo</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </header>
        <!-- main-header end -->

        <!-- Mobile Menu  -->
        <div class="mobile-menu">
            <div class="menu-backdrop"></div>
            <div class="close-btn"><i class="fas fa-times"></i></div>

            <nav class="menu-box">
                <div class="nav-logo"><a href="index.html"><img src="assets/images/logo-2.png" alt="" title=""></a></div>
                <div class="menu-outer"><!--Here Menu Will Come Automatically Via Javascript / Same Menu as in Header--></div>
                <div class="contact-info">
                    <h4>Contact Info</h4>
                    <ul>
                        <li>Chicago 12, Melborne City, USA</li>
                        <li><a href="tel:+8801682648101">+88 01682648101</a></li>
                        <li><a href="mailto:info@example.com">info@example.com</a></li>
                    </ul>
                </div>
                <div class="social-links">
                    <ul class="clearfix">
                        <li><a href="index.html"><span class="fab fa-twitter"></span></a></li>
                        <li><a href="index.html"><span class="fab fa-facebook-square"></span></a></li>
                        <li><a href="index.html"><span class="fab fa-pinterest-p"></span></a></li>
                        <li><a href="index.html"><span class="fab fa-instagram"></span></a></li>
                        <li><a href="index.html"><span class="fab fa-youtube"></span></a></li>
                    </ul>
                </div>
            </nav>
        </div><!-- End Mobile Menu -->

        <!-- page-title -->
        <section class="page-title centred">
            <div class="bg-layer" style="background-image: url(assets/images/background/page-title.jpg);"></div>
            <div class="auto-container">
                <div class="content-box">
                    <h1>My Account</h1>
                    <ul class="bread-crumb clearfix">
                        <li><a href="index.html">Home</a></li>
                        <li>Account</li>
                    </ul>
                </div>
            </div>
        </section>
        <!-- page-title end -->

        <!-- account-section -->
        <section class="sec-pad">
            <div class="auto-container">
                <div class="sec-title centred mb_50">
                    <span class="sub-title">Subscription Management</span>
                    <h2>Your AiVRIC Subscriptions</h2>
                </div>

                <!-- Loading State -->
                <div id="loading-section" class="loading-spinner">
                    <div class="spinner"></div>
                    <p class="mt-3">Loading your subscription information...</p>
                </div>

                <!-- Subscription Content (Hidden initially) -->
                <div id="subscription-content" style="display: none;">
                    <div class="row">
                        <!-- Subscription Overview Card -->
                        <div class="col-lg-8 col-md-12">
                            <div class="subscription-card">
                                <h3>Active Subscriptions</h3>
                                <div id="subscriptions-list">
                                    <!-- Dynamically populated -->
                                </div>

                                <div id="no-subscriptions" style="display: none;">
                                    <p class="text-muted">You don't have any active subscriptions.</p>
                                    <a href="pricing.html" class="theme-btn-one mt-3">View Pricing Plans</a>
                                </div>
                            </div>

                            <!-- Payment History Card -->
                            <div class="subscription-card">
                                <h3>Payment History</h3>
                                <div id="payment-history-list">
                                    <!-- Dynamically populated -->
                                </div>
                            </div>
                        </div>

                        <!-- Actions Sidebar -->
                        <div class="col-lg-4 col-md-12">
                            <div class="subscription-card">
                                <h4>Manage Subscription</h4>
                                <p class="text-muted">Update your payment method, billing information, or cancel your subscription.</p>
                                <button type="button" class="theme-btn-one w-100" data-stripe-portal>
                                    <i class="fas fa-cog"></i> Manage Billing
                                </button>
                            </div>

                            <div class="subscription-card">
                                <h4>Need More Products?</h4>
                                <p class="text-muted">Upgrade or add additional AiVRIC products to your subscription.</p>
                                <a href="pricing.html" class="theme-btn-one w-100">View All Plans</a>
                            </div>

                            <div class="subscription-card">
                                <h4>Support</h4>
                                <p class="text-muted">Need help with your subscription?</p>
                                <a href="contact.html" class="theme-btn-one w-100">Contact Support</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Error State -->
                <div id="error-section" style="display: none;">
                    <div class="subscription-card text-center">
                        <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
                        <h4>Unable to Load Subscription Information</h4>
                        <p class="text-muted">Please make sure you're logged in and try again.</p>
                        <a href="index.html" class="theme-btn-one mt-3">Return to Home</a>
                    </div>
                </div>
            </div>
        </section>
        <!-- account-section end -->

        <!-- main-footer -->
        <footer class="main-footer">
            <div class="widget-section">
                <div class="pattern-layer">
                    <div class="pattern-1" style="background-image: url(assets/images/shape/shape-20.png);"></div>
                    <div class="pattern-2" style="background-image: url(assets/images/shape/shape-21.png);"></div>
                </div>
                <div class="auto-container">
                    <div class="row clearfix">
                        <div class="col-lg-3 col-md-6 col-sm-12 footer-column">
                            <div class="logo-widget footer-widget">
                                <figure class="footer-logo"><a href="index.html"><img src="assets/images/footer-logo.png" alt=""></a></figure>
                                <div class="text">
                                    <p>Comprehensive security platform for modern organizations.</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6 col-sm-12 footer-column">
                            <div class="links-widget footer-widget ml_50">
                                <div class="widget-title">
                                    <h3>Quick Link</h3>
                                </div>
                                <div class="widget-content">
                                    <ul class="links-list clearfix">
                                        <li><a href="about.html">About Us</a></li>
                                        <li><a href="services.html">Services</a></li>
                                        <li><a href="pricing.html">Pricing</a></li>
                                        <li><a href="contact.html">Contact Us</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6 col-sm-12 footer-column">
                            <div class="links-widget footer-widget ml_30">
                                <div class="widget-title">
                                    <h3>Useful Links</h3>
                                </div>
                                <div class="widget-content">
                                    <ul class="links-list clearfix">
                                        <li><a href="#">Privacy Policy</a></li>
                                        <li><a href="#">Terms & Condition</a></li>
                                        <li><a href="contact.html">Support</a></li>
                                        <li><a href="faq.html">FAQ</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6 col-sm-12 footer-column">
                            <div class="contact-widget footer-widget">
                                <div class="widget-title">
                                    <h3>Contact</h3>
                                </div>
                                <div class="widget-content">
                                    <ul class="info-list clearfix">
                                        <li><i class="icon-23"></i>New Hyde Park, NY 11040</li>
                                        <li><i class="icon-3"></i><a href="mailto:support@aivric.com">support@aivric.com</a></li>
                                        <li><i class="icon-2"></i><a href="tel:3336660000">333 666 0000</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer-bottom centred">
                <div class="auto-container">
                    <div class="copyright">
                        <p>Copyright 2025 by <a href="index.html">AiVRIC</a>. All Rights Reserved.</p>
                    </div>
                </div>
            </div>
        </footer>
        <!-- main-footer end -->

        <!--Scroll to top-->
        <div class="scroll-to-top">
            <div>
                <div class="scroll-top-inner">
                    <div class="scroll-bar">
                        <div class="bar-inner"></div>
                    </div>
                    <div class="scroll-bar-text">Go To Top</div>
                </div>
            </div>
        </div>
        <!-- Scroll to top end -->

    </div>

    <!-- jequery plugins -->
    <script src="assets/js/jquery.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/owl.js"></script>
    <script src="assets/js/wow.js"></script>
    <script src="assets/js/validation.js"></script>
    <script src="assets/js/jquery.fancybox.js"></script>
    <script src="assets/js/appear.js"></script>
    <script src="assets/js/scrollbar.js"></script>
    <script src="assets/js/isotope.js"></script>
    <script src="assets/js/jquery.nice-select.min.js"></script>
    <script src="assets/js/parallax-scroll.js"></script>

    <!-- main-js -->
    <script src="assets/js/script.js"></script>

    <!-- Stripe Checkout Integration -->
    <script src="assets/js/stripe-checkout.js"></script>

    <!-- Account Page JavaScript -->
    <script>
        (function() {
            'use strict';

            const CONFIG = {
                defenseApiUrl: 'https://defense-api.aivric.com'
            };

            /**
             * Load and display subscription information
             */
            async function loadSubscriptionData() {
                try {
                    const token = localStorage.getItem('auth_token');
                    if (!token) {
                        throw new Error('Not authenticated');
                    }

                    // Get subscription status
                    const statusResponse = await fetch(`${CONFIG.defenseApiUrl}/api/v1/subscriptions/status`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    if (!statusResponse.ok) {
                        throw new Error('Failed to fetch subscription status');
                    }

                    const status = await statusResponse.json();

                    // Get payment history
                    const historyResponse = await fetch(`${CONFIG.defenseApiUrl}/api/v1/subscriptions/payment-history`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    const history = historyResponse.ok ? await historyResponse.json() : { payments: [] };

                    // Display the data
                    displaySubscriptions(status);
                    displayPaymentHistory(history.payments || []);

                    // Hide loading, show content
                    document.getElementById('loading-section').style.display = 'none';
                    document.getElementById('subscription-content').style.display = 'block';

                } catch (error) {
                    console.error('Error loading subscription data:', error);
                    document.getElementById('loading-section').style.display = 'none';
                    document.getElementById('error-section').style.display = 'block';
                }
            }

            /**
             * Display subscription information
             */
            function displaySubscriptions(status) {
                const subscriptionsList = document.getElementById('subscriptions-list');
                const noSubscriptions = document.getElementById('no-subscriptions');

                if (!status.subscriptions || status.subscriptions.length === 0) {
                    subscriptionsList.style.display = 'none';
                    noSubscriptions.style.display = 'block';
                    return;
                }

                subscriptionsList.innerHTML = '';
                status.subscriptions.forEach(sub => {
                    const productNames = {
                        defense: 'AiVRIC Defense',
                        offense: 'AiVRIC Offense',
                        vision: 'AiVRIC Vision',
                        bundle_defense_offense: 'Defense + Offense Bundle',
                        bundle_all: 'Complete Platform'
                    };

                    const statusClass = sub.status === 'active' ? 'status-active' :
                                      sub.status === 'trialing' ? 'status-trial' : 'status-inactive';

                    const html = `
                        <div class="subscription-detail">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h4 class="mb-0">
                                    ${sub.products.map(p => productNames[p] || p).join(', ')}
                                </h4>
                                <span class="subscription-status ${statusClass}">
                                    ${sub.status.toUpperCase()}
                                </span>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>Started:</strong> ${new Date(sub.current_period_start).toLocaleDateString()}</p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>Renews:</strong> ${new Date(sub.current_period_end).toLocaleDateString()}</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                ${sub.products.map(p => `<span class="product-badge">${productNames[p] || p}</span>`).join('')}
                            </div>
                        </div>
                    `;
                    subscriptionsList.innerHTML += html;
                });
            }

            /**
             * Display payment history
             */
            function displayPaymentHistory(payments) {
                const historyList = document.getElementById('payment-history-list');

                if (!payments || payments.length === 0) {
                    historyList.innerHTML = '<p class="text-muted">No payment history yet.</p>';
                    return;
                }

                historyList.innerHTML = '';
                payments.slice(0, 5).forEach(payment => {
                    const statusIcon = payment.status === 'succeeded' ?
                        '<i class="fas fa-check-circle text-success"></i>' :
                        '<i class="fas fa-times-circle text-danger"></i>';

                    const html = `
                        <div class="d-flex justify-content-between align-items-center py-2 border-bottom">
                            <div>
                                ${statusIcon}
                                <strong>${new Date(payment.created).toLocaleDateString()}</strong>
                            </div>
                            <div>
                                <strong>$${(payment.amount / 100).toFixed(2)}</strong>
                            </div>
                        </div>
                    `;
                    historyList.innerHTML += html;
                });
            }

            // Initialize when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', loadSubscriptionData);
            } else {
                loadSubscriptionData();
            }

        })();
    </script>

</body><!-- End of .page_wrapper -->
</html>
